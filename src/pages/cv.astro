---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { Image } from "astro:assets";
import cvPreviewImg from "../assets/cv-preview.jpg";

/* GitLab Pages SAFE */
const base = import.meta.env.BASE_URL.replace(/\/$/, "");
const cvUrl = `${base}/cv.pdf`;
---

<!doctype html>
<html lang="fr">
  <head>
    <BaseHead title={`CV | ${SITE_TITLE}`} description={SITE_DESCRIPTION} />
  </head>

  <body>
    <!-- BACKGROUND -->
    <div class="fixed-background">
      <div class="blob purple"></div>
      <div class="blob blue"></div>
      <div class="blob cyan"></div>
    </div>

    <Header />

    <main class="container">
      <!-- HERO -->
      <section class="cv-hero">
        <span class="badge">MON CV</span>

        <h1>
          Mon parcours
          <span class="text-gradient d-block">professionnel</span>
        </h1>

        <p class="subtitle">
          Développeur multimédia & créatif, passionné par le web, le design et
          la technique.
        </p>

        <div class="cta">
          <a
            href={cvUrl}
            download="CV - Tom Marcheron.pdf"
            class="btn btn-primary"
          >
            Télécharger le CV
          </a>
          <a href="#preview" class="btn btn-secondary"> Voir le document </a>
        </div>
      </section>

      <!-- PREVIEW -->
      <section id="preview" class="preview">
        <div class="document">
          <div class="document-bar">
            <div class="dots">
              <span class="dot red"></span>
              <span class="dot yellow"></span>
              <span class="dot green"></span>
            </div>
            <span class="filename">CV - Tom Marcheron</span>
          </div>

          <div class="document-content">
            <a
              href={cvUrl}
              target="_blank"
              class="cv-preview-link"
              title="Ouvrir le CV en PDF"
            >
              <!-- Placeholder Image - Remplacez 'cv-preview.jpg' par une image de votre CV -->
              <Image
                src={cvPreviewImg}
                alt="Aperçu du CV de Tom Marcheron"
                class="cv-img"
                loading="eager"
              />
            </a>
          </div>
        </div>
      </section>
    </main>

    <Footer />
  </body>
</html>

<style>
  .cv-hero {
    padding: 6rem 1rem 3rem;
    text-align: center;
  }

  .cv-hero h1 {
    font-size: clamp(3rem, 6vw, 5rem);
    line-height: 1.1;
    margin: 1.5rem 0;
    font-weight: 900;
  }

  .subtitle {
    max-width: 700px;
    margin: 0 auto 2.5rem;
    font-size: 1.1rem;
    color: var(--color-text-soft);
  }

  .cta {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  /* PREVIEW */

  .preview {
    padding: 3rem 0 6rem;
  }

  .document {
    background: white;
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-strong);
    overflow: hidden;
    height: 850px;
    animation: appear 0.8s ease forwards;
    transform: translateY(40px);
    opacity: 0;
  }

  @keyframes appear {
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  .document-bar {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem 1rem;
    background: #f9fafb;
    border-bottom: 1px solid var(--color-border);
  }

  .dots {
    display: flex;
    gap: 6px;
  }

  .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
  }

  .red {
    background: #ff5f56;
  }
  .yellow {
    background: #ffbd2e;
  }
  .green {
    background: #27c93f;
  }

  .filename {
    font-family: monospace;
    font-size: 0.8rem;
    color: #6b7280;
  }

  .document-content {
    height: calc(100% - 42px);
    background: #e5e7eb;
  }

  .cv-preview-link {
    display: block;
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
  }

  .cv-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: white;
    transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  /* Effet de zoom fluide au survol */
  .cv-preview-link:hover .cv-img {
    transform: scale(1.03);
    cursor: pointer;
  }

  .fallback {
    height: 100%;
    display: grid;
    place-content: center;
    text-align: center;
    gap: 1rem;
  }

  @media (max-width: 768px) {
    .document {
      height: 500px;
    }
  }

  .d-block {
    display: block;
  }
</style>
